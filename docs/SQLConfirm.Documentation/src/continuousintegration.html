<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>DBConfirm - Documentation</title>
    <meta name="description"
        content="The official documentation for DBConfirm, the unit testing framework for SQL databases.">
    <meta name="author" content="Bungalow64 Technologies Ltd">

    <link rel="stylesheet" href="/styles/main.css?v=1.0">
</head>

<body>

    <div id="sidebar">
        <div id="sidebar-heading">
            DBConfirm
        </div>
        <nav>
            <ul id="menu">
                <li><a href="index.html">Overview</a></li>
                <li><a href="quickstart.html">Quick Start</a></li>
                <li><a href="nuget.html">NuGet Packages</a></li>
                <li><a href="templates.html">Templates</a></li>
                <li class="active"><a href="continuousintegration.html">Continuous Integration</a></li>
                <li><a href="api.html">API Reference</a></li>
            </ul>
        </nav>
    </div>
    <div id="content">

        <h1>DBConfirm - Documentation</h1>

        <h2 id="continuousintegration">Continuous Integration</h2>
        <p>DBConfirm tests are integrated with existing test frameworks, so tests will be run by any Continuous
            Integration (CI) build that
            can run tests in that framework.</p>
        <p>The only different between a standard unit test suite and a DBConfirm test suite is that DBConfirm requires
            an actual database to test against,
            so this database needs to be accessible by the build agent.</p>
        <p>There are 3 ways to configure the connection string used by the tests, which are checked in this order:
        </p>
        <ul>
            <li><a href="#environmentvariables">1. Environment Variables</a></li>
            <li><a href="#runsettings">2. .runsettings</a></li>
            <li><a href="#appsettings">3. appsettings.json</a></li>
        </ul>
        <h3 id="environmentvariables">Configure using Environment Variables</h3>
        <p>This is the recommended approach to configuring the CI build.</p>
        <p>During the test initialisation, the current environment variables are checked for a variable called
            '<strong>ConnectionString</strong>', and if
            a value is found, this connection string is used.</p>
        <p>To set this environment variable, see the configuration for the CI build itself.</p>
        <p>For example, in Azure DevOps, the environment variables are listed as '<strong>Variables</strong>':
        </p>
        <p><img src="images/ci_connectionstring.png"
                alt="The ConnectionString environment variable added to a Pipeline build in Azure DevOps"
                style="width: 100%; min-width: 700px; max-width: 1481px;" /></p>


        <h3 id="runsettings">Configure using a .runsettings file</h3>
        <p>During test initialisation, if no environment variable is found, DBConfirm will next check for a
            .runsettings file.</p>
        <p>If a .runsettings file is found, a parameter called '<strong>ConnectionString</strong>' is checked, and used
            if found.</p>
        <p>An example .runsettings file is:</p>
        <pre><code class="lang-xml"><span class="hljs-meta">&lt;?</span><span class="hljs-tag">xml</span> <span class="hljs-attr">version</span>="<span class="hljs-string">1.0</span>" <span class="hljs-attr">encoding</span>="<span class="hljs-string">utf-8</span>"<span class="hljs-meta">?&gt;</span>
&lt;<span class="hljs-tag">RunSettings</span>&gt;
    &lt;<span class="hljs-tag">TestRunParameters</span>&gt;
        &lt;<span class="hljs-tag">Parameter</span> <span class="hljs-attr">name</span>="<span class="hljs-string">ConnectionString</span>" <span class="hljs-attr">value</span>="<span class="hljs-string">SERVER=B64-BUILD-DB;DATABASE=Northwind;Integrated Security=true;Connection Timeout=30;</span>" /&gt;
    &lt;/<span class="hljs-tag">TestRunParameters</span>&gt;
&lt;/<span class="hljs-tag">RunSettings</span>&gt;
</code></pre>

        <h3 id="appsettings">Configure using appsettings.json</h3>
        <p>This method is recommended for local development and testing, but since it can't easily be changed as part of a CI build, it should only be used as a last resort for builds.</p>
        <p>During test initialisation, if no environment variable or .runsettings variable is found, then the appsettings.json file is checked for a connection string 
            with a name of '<strong>TestDatabase</strong>'.
        </p>
        <p>An example appsettings.json file is:</p>
        <pre><code class="lang-json">{
    <span class="hljs-attr">"ConnectionStrings"</span>: {
        <span class="hljs-attr">"TestDatabase"</span>: <span class="hljs-string">"SERVER=(local);DATABASE=SampleDB;Integrated Security=true;Connection Timeout=30;"</span>
    }
}
</code></pre>
          
    </div>
</body>

</html>