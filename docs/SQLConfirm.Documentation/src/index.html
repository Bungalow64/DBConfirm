<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>DBConfirm - Documentation</title>
    <meta name="description"
        content="The official documentation for DBConfirm, the unit testing framework for SQL databases.">
    <meta name="author" content="Bungalow64 Technologies Ltd">

    <link rel="stylesheet" href="/styles/main.css?v=1.0">
</head>

<body>

    <div id="sidebar">
        <div id="sidebar-heading">
            DBConfirm
        </div>
        <nav>
            <ul id="menu">
                <li class="active"><a href="index.html">Overview</a></li>
                <li><a href="quickstart.html">Quick Start</a></li>
                <li><a href="nuget.html">NuGet Packages</a></li>
                <li><a href="templates.html">Templates</a></li>
                <li><a href="continuousintegration.html">Continuous Integration</a></li>
                <li><a href="api.html">API Reference</a></li>
            </ul>
        </nav>
    </div>
    <div id="content">

        <h1>DBConfirm - Documentation</h1>

        <h2 id="introduction">Introduction</h2>
        <p>A C#-based testing framework to write and run tests for logic within SQL Server</p>
        <p><a target="_blank" href="https://www.nuget.org/packages/DBConfirm.Core/"><img
                    src="https://img.shields.io/nuget/v/DBConfirm.Core" alt=""></a>
            <a target="_blank" href="https://www.nuget.org/packages/DBConfirm.Core/"><img
                    src="https://img.shields.io/nuget/dt/DBConfirm.Core" alt=""></a>
            <a target="_blank"
                href="https://dev.azure.com/bungalow64/Bungalow64.SqlTesting/_build/latest?definitionId=1"><img
                    src="https://dev.azure.com/bungalow64/Bungalow64.SqlTesting/_apis/build/status/Bungalow64.SqlTesting/Sprint-CI"
                    alt="Build Status"></a></p>
        <h2 id="what-is-DBConfirm-">What is DBConfirm?</h2>
        <p>DBConfirm is a unit testing framework for SQL databases from within .Net projects.</p>
        <h2 id="why-">Why?</h2>
        <p>Developers are pretty good at writing unit tests for their application logic already, but sometimes database
            logic (stored procedures, views, etc.) can be overlooked. A big reason is that traditionally SQL unit tests
            are
            difficult to write, or have a very steep learning curve. DBConfirm aims to solve this by allowing SQL tests
            to
            be written in the same way that all other unit tests are written, so that they are easy to write, easy to
            maintain, and easy to run.</p>
        <h2 id="how-">How?</h2>
        <p>The DBConfirm framework is designed to execute tests against a physical instance of the database under test,
            and
            ensures that each test run is accurate and repeatable by making sure all effects of a test are rolled back
            when
            the test has finished.</p>

            <h2 id="what-does-a-DBConfirm-test-look-like-">What does a DBConfirm test look like?</h2>
        <div class="content-split">
            <div class="content-split-primary">
                <p>A simple test (in MSTest) to call a stored procedure then verify that the data has been added, looks
                    like
                    this:
                </p>
                <pre><code class="lang-csharp">[<span class="hljs-type">TestMethod</span>]
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-type">Task</span> <span class="hljs-title">AddUserProcedure_UserIsAdded</span>(<span class="hljs-params"></span>)
</span>{
    <span class="hljs-comment">// Call a stored procedure with some parameters</span>
    <span class="hljs-keyword">await</span> TestRunner.<span class="hljs-title">ExecuteStoredProcedureNonQueryAsync</span>(<span class="hljs-string">"dbo.AddUser"</span>,
        <span class="hljs-keyword">new</span> <span class="hljs-type">SqlQueryParameter</span>(<span class="hljs-string">"FirstName"</span>, <span class="hljs-string">"Jamie"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-type">SqlQueryParameter</span>(<span class="hljs-string">"LastName"</span>, <span class="hljs-string">"Burns"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-type">SqlQueryParameter</span>(<span class="hljs-string">"EmailAddress"</span>, <span class="hljs-string">"jamie@example.com"</span>));

    <span class="hljs-comment">// Get all the data in a table</span>
    <span class="hljs-type">QueryResult</span> data = <span class="hljs-keyword">await</span> TestRunner.<span class="hljs-title">ExecuteTableAsync</span>(<span class="hljs-string">"dbo.Users"</span>);

    <span class="hljs-comment">// Make some assertions on the data</span>
    data
        .<span class="hljs-title">AssertRowCount</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">// Asserts that there is only 1 row</span>
        .<span class="hljs-title">AssertValue</span>(<span class="hljs-number">0</span>, <span class="hljs-string">"FirstName"</span>, <span class="hljs-string">"Jamie"</span>); <span class="hljs-comment">// Asserts that "FirstName" is "Jamie" in the first row</span>
}
</code></pre>
            </div>
            <aside>
                <header id="the-fundamentals-of-a-DBConfirm-test">The fundamentals of a DBConfirm test</header>
                <div class="aside-body">
                <h3 id="arrange-set-up-any-prerequisite-test-data">1. Arrange - set up any prerequisite test data</h3>
                <p>Data can be inserted into any table in the database using either the DBConfirm API or by creating
                    templates that are used to set up complex scenarios across multiple tests.  See <a href="templates.html">templates</a> for more details.</p>
                <h3 id="act-run-the-sql-you-want-to-test">2. Act - run the SQL you want to test</h3>
                <p>Using the DBConfirm API you can trigger any stored procedure, query any view, or run any arbitrary
                    SQL statement.</p>
                <h3 id="assert-check-the-returned-data-and-check-the-state-of-data-in-the-database">3. Assert - check
                    the returned data, and check the state of data in the database</h3>
                <p>The DBConfirm API provides a whole bunch of assertion methods that you can run on the returned data,
                    including checking specific columns are present, that values are what you expect them to be, and that at least
                    one row meets your conditions, etc.</p>
                <p>You can also use the DBConfirm API to query the data in tables, and run the same assertions, to make
                    sure the data is in the exact state that you expect.</p>
                </div>
            </aside>
        </div>

        <h2 id="getting-started">Getting started</h2>
        <p>See the <a href="quickstart.html">Quick Start</a> guide for getting started.</p>
    </div>
</body>

</html>